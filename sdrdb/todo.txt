implement weighting

use async

implement saving, loading
